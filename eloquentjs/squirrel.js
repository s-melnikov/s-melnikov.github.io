var JOURNAL = [];

function addEntry(events, didITurnIntoASquirrel) {
  JOURNAL.push({
    events: events,
    squirrel: didITurnIntoASquirrel
  });
}

addEntry(["морковь","упражнения","выходной"],false);
addEntry(["хлеб","пудинг","чистил зубы","выходной","касался дерева"],false);
addEntry(["морковь","начос","чистил зубы","велосипед","выходной"],false);
addEntry(["брюссельская капуста","мороженое","чистил зубы","компьютер","выходной"],false);
addEntry(["картошка","конфеты","чистил зубы","упражнения","выходной","дантист"],false);
addEntry(["брюссельская капуста","пудинг","чистил зубы","бегал","выходной"],false);
addEntry(["пица","чистил зубы","компьютер","работа","касался дерева"],false);
addEntry(["хлеб","пиво","чистил зубы","велосипед","работа"],false);
addEntry(["цветная капуста","чистил зубы","работа"],false);
addEntry(["пица","чистил зубы","велосипед","работа"],false);
addEntry(["лазанья","начос","чистил зубы","работа"],false);
addEntry(["чистил зубы","выходной","касался дерева"],false);
addEntry(["салат","чистил зубы","телевизор","выходной"],false);
addEntry(["спагетти","чистил зубы","работа"],false);
addEntry(["чистил зубы","компьютер","работа"],false);
addEntry(["салат","начос","чистил зубы","работа"],false);
addEntry(["морковь","чистил зубы","бегал","работа"],false);
addEntry(["чистил зубы","работа"],false);
addEntry(["цветная капуста","читал","выходной"],false);
addEntry(["хлеб","чистил зубы","выходной"],false);
addEntry(["лазанья","чистил зубы","упражнения","работа"],false);
addEntry(["спагетти","чистил зубы","читал","работа"],false);
addEntry(["морковь","мороженое","чистил зубы","телевизор","работа"],false);
addEntry(["спагетти","начос","работа"],false);
addEntry(["цветная капуста","мороженое","чистил зубы","велосипед","работа"],false);
addEntry(["спагетти","орехи","компьютер","выходной"],true);
addEntry(["картошка","мороженое","чистил зубы","компьютер","выходной"],false);
addEntry(["картошка","мороженое","чистил зубы","работа"],false);
addEntry(["орехи","чистил зубы","бегал","работа"],false);
addEntry(["картошка","упражнения","работа"],false);
addEntry(["пица","мороженое","компьютер","работа"],false);
addEntry(["лазанья","мороженое","работа"],false);
addEntry(["цветная капуста","конфеты","читал","выходной"],false);
addEntry(["лазанья","начос","чистил зубы","бегал","выходной"],false);
addEntry(["картошка","чистил зубы","работа"],false);
addEntry(["морковь","работа"],false);
addEntry(["пица","пиво","работа","дантист"],false);
addEntry(["лазанья","пудинг","велосипед","работа"],false);
addEntry(["спагетти","чистил зубы","читал","работа"],false);
addEntry(["спагетти","пудинг","телевизор","выходной"],false);
addEntry(["хлеб","чистил зубы","упражнения","выходной"],false);
addEntry(["лазанья","орехи","работа"],true);
addEntry(["пица","работа"],false);
addEntry(["картошка","упражнения","работа"],false);
addEntry(["чистил зубы","упражнения","работа"],false);
addEntry(["спагетти","чистил зубы","телевизор","работа"],false);
addEntry(["пица","велосипед","выходной"],false);
addEntry(["морковь","чистил зубы","выходной"],false);
addEntry(["морковь","пиво","чистил зубы","работа"],false);
addEntry(["пица","орехи","конфеты","работа"],true);
addEntry(["морковь","орехи","чистил зубы","читал","работа"],false);
addEntry(["картошка","орехи","чистил зубы","работа"],false);
addEntry(["морковь","начос","чистил зубы","упражнения","работа"],false);
addEntry(["пица","орехи","чистил зубы","телевизор","выходной"],false);
addEntry(["лазанья","чистил зубы","велосипед","выходной"],false);
addEntry(["цветная капуста","орехи","чистил зубы","компьютер","работа","касался дерева"],false);
addEntry(["салат","чистил зубы","телевизор","работа"],false);
addEntry(["картошка","чистил зубы","компьютер","работа"],false);
addEntry(["хлеб","конфеты","работа"],false);
addEntry(["картошка","начос","работа"],false);
addEntry(["морковь","пудинг","чистил зубы","выходной"],false);
addEntry(["морковь","чистил зубы","упражнения","выходной","касался дерева"],false);
addEntry(["брюссельская капуста","бегал","работа"],false);
addEntry(["чистил зубы","работа"],false);
addEntry(["салат","чистил зубы","бегал","работа"],false);
addEntry(["конфеты","чистил зубы","работа"],false);
addEntry(["брюссельская капуста","чистил зубы","компьютер","работа"],false);
addEntry(["хлеб","чистил зубы","выходной"],false);
addEntry(["цветная капуста","чистил зубы","выходной"],false);
addEntry(["спагетти","конфеты","телевизор","работа","касался дерева"],false);
addEntry(["морковь","пудинг","чистил зубы","работа"],false);
addEntry(["салат","чистил зубы","работа"],false);
addEntry(["морковь","мороженое","чистил зубы","велосипед","работа"],false);
addEntry(["пица","чистил зубы","работа"],false);
addEntry(["спагетти","орехи","упражнения","выходной"],true);
addEntry(["хлеб","пиво","компьютер","выходной","касался дерева"],false);
addEntry(["чистил зубы","бегал","работа"],false);
addEntry(["салат","орехи","чистил зубы","работа","касался дерева"],false);
addEntry(["лазанья","чистил зубы","телевизор","работа"],false);
addEntry(["цветная капуста","чистил зубы","бегал","работа"],false);
addEntry(["морковь","чистил зубы","бегал","работа"],false);
addEntry(["морковь","читал","выходной"],false);
addEntry(["морковь","орехи","читал","выходной"],true);
addEntry(["картошка","чистил зубы","бегал","работа"],false);
addEntry(["лазанья","мороженое","работа","касался дерева"],false);
addEntry(["цветная капуста","орехи","чистил зубы","велосипед","работа"],false);
addEntry(["пица","чистил зубы","бегал","работа"],false);
addEntry(["салат","чистил зубы","работа"],false);
addEntry(["хлеб","чистил зубы","телевизор","выходной"],false);
addEntry(["цветная капуста","орехи","чистил зубы","выходной"],false);

function phi(table) {
  return (table[3] * table[0] - table[2] * table[1]) /
    Math.sqrt((table[2] + table[3]) *
    (table[0] + table[1]) *
    (table[1] + table[3]) *
    (table[0] + table[2])
  );
}

function hasEvent(event, entry) {
  return entry.events.indexOf(event) != -1;
}

function tableFor(event, journal) {
  var table = [0, 0, 0, 0];
  for (var i = 0; i < journal.length; i++) {
    var entry = journal[i], index = 0;
    if (hasEvent(event, entry)) index += 1;
    if (entry.squirrel) index +=2;
    table[index] += 1;
  }
  return table;
}

function gatherCorrelations(journal) {
  var phis = {};
  for (var entry = 0; entry < journal.length; entry++) {
    var events = journal[entry].events;
    for (var i = 0; i < events.length; i++) {
      var event = events[i];
      if (!(event in phis)) {
        phis[event] = phi(tableFor(event, journal));
      }
    }
  }
  return phis;
}

var correlations = gatherCorrelations(JOURNAL);

for (var event in correlations) {
  var correlation = correlations[event];
  if (correlation > 0.1 || correlation < -0.1) {
    console.log(event + ": " + correlation);
  }
}

for (var i = 0; i < JOURNAL.length; i++) {
  var entry = JOURNAL[i];
  if (hasEvent("орехи", entry) && !hasEvent("чистил зубы", entry)) {
    entry.events.push("орехи / зубы");
  }
}

console.log(phi(tableFor("орехи / зубы", JOURNAL)));